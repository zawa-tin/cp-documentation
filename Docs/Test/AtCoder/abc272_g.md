---
title: ABC172-G Yet Another mod M
documentation_of: //Test/Manual/abc272_g.test.cpp
---

$A$ にもともと過半数を占める要素が存在する場合、任意の $3$ 以上の整数が条件を満たす。

そうで無いとき、適切に $M$ を取ることで $A$ 内の相異なる $2$ 要素以上を操作によって等しくする必要がある。

そのような $M$ は $|A_{i} - A_{j}|$ の約数に限られる。 ( $A_{i}$ と $A_{j}$ は相異なるとする )

なぜなら $A_{i} \equiv A_{j} \pmod{M}\ \to\ A_{i} - A_{j} \equiv 0\pmod{M}$ だからである。

このような $M$ の候補は $O(N^{2}\log (\max A))$ 個ある。この候補をさらに絞ることを考える。

列を円環とみなす。すなわち $i$ 番目の要素と $(i + 1)\pmod{N}$ 番目の要素が隣り合っているとする。

この円環に過半数を占める要素が存在する場合、隣合う $2$ つの要素がその過半数を占める要素であるような位置が必ず存在する。 <- これ天才

以上より、 $|A_{i} - A_{i + 1}|$ の約数のみを調べればよく、 $M$ の候補は $O(N\log (\max A))$ 個となった。

Boyer-Moore majority vote algorithmのverifyの為にライブラリに収録したが、解法の方が興味深い...
