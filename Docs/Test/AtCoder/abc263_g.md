---
title: ABC263-G Erasing Prime Pairs
documentation_of: //Test/AtCoder/abc263_g.test.cpp
---

$2$ 以外の素数は奇数であり、２つの整数の和で表そうとすると必ず「奇数 + 偶数」の形になる。よって2を考慮しなければ二部グラフ上の最大マッチングに帰着する。

$2$ を考慮する。$2$ を２つの正整数の和で表す方法は「1 + 1」しかありえない。反対に $A_{i} = 1$ なる整数は同じ種類の整数とマッチできるので自由度が高い。

以下のようにする。

1. 1以外の整数を考慮した状態で最大フロー $f$ (及び最大フローから誘導される残余ネットワーク $G_{f}$ )を求める
2. $G_{f}$ に整数1を考慮した辺を追加し、もう一回最大フローを求める(1 -> 1という辺は追加しない。二部グラフで無くなってしまう)
3. 残った1の数がわかるので、1同士でマッチさせる。

例えば、 $\\{ 1, 1, 2, 4 \\}$ の時は $(1, 1)$ のペアを作るのをできるだけ後回しにして、1を別の整数とくっつけて上げる。一般の整数の集合でそのようにして損をすることはありえない

$1$ は自分同士でくっつくことができるので、 $\\{ 1, 1, 2, 5 \\}$ とかだと $(1, 2)$ より $(2, 5)$ を優先するべきだ。(これも一般の整数の集合で言える)

マッチングを最大化する際は、マッチングできる相手が少ないものから考慮していくとうまく貪欲法を構築・証明できることが多いようだ。

参考にしました: [最大マッチングを貪欲する問題の証明典型テク](https://snuke.hatenablog.com/entry/2019/01/04/004133)
