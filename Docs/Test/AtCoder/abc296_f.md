---
title: ABC296-F Simultaneous Swap (互換は奇数回の隣接swap)
documentation_of: //Test/AtCoder/abc296_f.test.cpp
---

長さ $N$ の数列 $A = (A_{1}, A_{2}, \dots, A_{N})$ の $L$ 番目の要素と $R$ 番目の要素をswapすることを考える。

これは $2(R - L - 1) + 1$ 回の隣接要素のswapで実現できる。

$A_{L}$ の要素を $A_{R}$ のところに運ぶのに $R - L$ 回のswap、現在 $A_{R}$ は $R - 1$ 番目にいて、これを $L$ 番目に運ぶのに $R - L - 1$ 回のswapを要する。

$2\times$ 整数 $+1$ の形で表現できる整数は奇数であることを思い出すと、以下が成り立つことがわかる。

**順列は互換( $L$ 番目の要素と $R$ 番目の要素をswapする)によって転倒数の偶奇が必ず入れ替わる**

<br />

この事実を利用してこの問題を解くことができる。 

$A, B$ が多重集合として一致していることを仮定する。

### $A$ がdistinctのとき

操作によって $A$ の転倒数の偶奇、 $B$ の転倒数の偶奇は必ず入れ替わる。すなわち $A$ の転倒数 - $B$ の転倒数の偶奇は不変である。

よって $A$ の転倒数の偶奇と $B$ の転倒数の偶奇が一致していることが必要だが、実は十分条件にもなっている。実際に操作列を構築することで示せるようだ。

### $A$ がdistinctでないとき

うまく $(i, j, k)$ を選ぶことで転倒数の偶奇すらずらせる。常にYes
