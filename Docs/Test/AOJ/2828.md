---
title: AOJ2828 マトリョーシカ
documentation_of: //Test/AOJ/2828.test.cpp
---

DAG上の最大重み付きパス被覆問題に帰着する。DAG上の最小パス被覆問題は最大二部マッチング問題に帰着するので、この問題は最小費用流で解けることが予想できる。

DAG上の最小パス被覆問題は以下のように解く

1. $2|V| + 2$ 頂点用意する。 $V = \\{ \text{source}, 0, 1, \dots, n - 1, 0', 1', \dots, (n - 1)', \text{sink} \\}$ とする。

2. $\text{source}$ から頂点 $0, 1, \dots, n - 1$ に容量1の辺を張る

3. 頂点 $0', 1', \dots, (n - 1)'$ から $\text{sink}$ に容量1の辺を張る

4. 元のDAG上で頂点 $i$ から頂点 $j$ へ有向辺が存在するなら、 頂点 $i$ から頂点 $j'$ へ容量1の辺を張る

5. $\text{source}$ から $\text{sink}$ への最大流 $F$ を求める。

6. $|V| - |F|$ が解である。

大雑把に言うとマッチングの辺の数がDAG上のパスの始点で無い頂点の個数と一致するため、これを最大化するとパスの個数が最小化される。詳しい解説は蟻本p242 Stock Chartsが詳しい。

これに重みをつけるのは簡単で、 $4$ で張る辺にマトリョーシカ $j$ の体積をコストにすれば良い。

- この重み付き二部最大マッチングは、外側に見えていないマトリョーシカの体積の和に一致する。
