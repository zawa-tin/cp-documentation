---
title: AOJ3369 Namori Counting (行列木定理)
documentation_of: //Test/Manual/aoj3369.test.cpp
---

$M - N$ 本の辺を削除してから頂点に色を塗ると考えて良い。

解はグラフの全域木の数に $M - (N - 1)$ をかけた値である。なもりグラフは全域木に辺を一本追加することで作ることができる。全域木の数 $\times M - (N - 1)$ という値は各なもりグラフを丁度閉路サイズ回重複して数え上げた値となっている。

**グラフの全域木の数**

単純なグラフ$G(V, E)$に対して $N$ 行 $N$ 列の行列 $L$ を以下のように定義する。

- 頂点 $v$ の次数が $d_{v}$ なら、 $L_{vv} = d_{v}$
- $u\ne v$ に対して、 $L_{uv}$ を頂点対 $(u, v)$ を直接結ぶ辺の数を $-1$ 倍したもの。

この $L$ の任意の余因子が $G$ の全域木の数に一致する。 (行列木定理)
