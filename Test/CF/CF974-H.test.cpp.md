---
data:
  _extendedDependsOn:
  - icon: ':heavy_check_mark:'
    path: Src/DataStructure/Mo/Mo.hpp
    title: Mo's algorithm
  - icon: ':heavy_check_mark:'
    path: Src/Template/TypeAlias.hpp
    title: "\u6A19\u6E96\u30C7\u30FC\u30BF\u578B\u306E\u30A8\u30A4\u30EA\u30A2\u30B9"
  _extendedRequiredBy: []
  _extendedVerifiedWith: []
  _isVerificationFailed: false
  _pathExtension: cpp
  _verificationStatusIcon: ':heavy_check_mark:'
  attributes:
    '*NOT_SPECIAL_COMMENTS*': ''
    PROBLEM: https://onlinejudge.u-aizu.ac.jp/courses/lesson/2/ITP1/1/ITP1_1_A
    links:
    - https://codeforces.com/contest/2014/problem/H
    - https://codeforces.com/contest/2014/submission/315528073
    - https://onlinejudge.u-aizu.ac.jp/courses/lesson/2/ITP1/1/ITP1_1_A
  bundledCode: "#line 1 \"Test/CF/CF974-H.test.cpp\"\n#define PROBLEM \"https://onlinejudge.u-aizu.ac.jp/courses/lesson/2/ITP1/1/ITP1_1_A\"\
    \n// #define PROBLEM \"https://codeforces.com/contest/2014/problem/H\"\n\n/*\n\
    \ * Codeforces Round 974 (Div. 3) H. Robin Hood Archery\n * https://codeforces.com/contest/2014/submission/315528073\n\
    \ */\n\n#line 2 \"Src/DataStructure/Mo/Mo.hpp\"\n\n#line 2 \"Src/Template/TypeAlias.hpp\"\
    \n\n#include <cstdint>\n#include <cstddef>\n\nnamespace zawa {\n\nusing i16 =\
    \ std::int16_t;\nusing i32 = std::int32_t;\nusing i64 = std::int64_t;\nusing i128\
    \ = __int128_t;\n\nusing u8 = std::uint8_t;\nusing u16 = std::uint16_t;\nusing\
    \ u32 = std::uint32_t;\nusing u64 = std::uint64_t;\n\nusing usize = std::size_t;\n\
    \n} // namespace zawa\n#line 4 \"Src/DataStructure/Mo/Mo.hpp\"\n\n#include <algorithm>\n\
    #include <bit>\n#include <cassert>\n#include <vector>\n#include <type_traits>\n\
    \nnamespace zawa {\n\nnamespace internal {\n\n// reference: https://codeforces.com/blog/entry/61203?#comment-1064868\n\
    u64 hilbertOrder(u64 x, u64 y, usize dim) {\n    const u64 max{(1ull << dim) -\
    \ 1};\n    assert(x <= max);\n    assert(y <= max);\n    u64 res{};\n    for (u64\
    \ s{1ull << (dim - 1)} ; s ; s >>= 1) {\n        bool rx{static_cast<bool>(x &\
    \ s)}, ry{static_cast<bool>(y & s)};\n        res = (res << 2) | (rx ? ry ? 2\
    \ : 1 : ry ? 3 : 0);\n        if (!rx) {\n            if (ry) x ^= max, y ^= max;\n\
    \            std::swap(x, y);\n        }\n    }\n    return res;\n}\n\n} // namespace\
    \ internal\n\ntemplate <class T, class AddL, class AddR, class DelL, class DelR,\
    \ class Eval>\nstd::vector<typename std::invoke_result_t<Eval, usize>> Mo(std::vector<T>\
    \ qs, AddL addL, AddR addR, DelL delL, DelR delR, Eval eval, bool reset = false)\
    \ {\n    usize log{};\n    for (const T& lr : qs) log = std::max<usize>(log, std::bit_width(lr.r));\n\
    \    std::vector<std::pair<T, usize>> ord(qs.size());\n    std::vector<u64> h(qs.size());\n\
    \    for (usize i{} ; i < qs.size() ; i++) {\n        ord[i] = {qs[i], i};\n \
    \       h[i] = internal::hilbertOrder(qs[i].l, qs[i].r, log);\n    }\n    std::sort(ord.begin(),\
    \ ord.end(), [&](const auto& L, const auto& R) -> bool {\n            return h[L.second]\
    \ < h[R.second];\n            });\n    std::vector<typename std::invoke_result_t<Eval,\
    \ usize>> res(qs.size());\n    usize L{}, R{};\n    for (const auto& [lr, id]\
    \ : ord) {\n        while (R < lr.r) addR(R++);\n        while (L > lr.l) addL(--L);\n\
    \        while (R > lr.r) delR(--R);\n        while (L < lr.l) delL(L++);\n  \
    \      res[id] = eval(id);\n    }\n    if (reset) while (R > L) delR(--R);\n \
    \   return res;\n}\n\n} // namespace zawa\n#line 10 \"Test/CF/CF974-H.test.cpp\"\
    \n\n#include <iostream>\n#line 13 \"Test/CF/CF974-H.test.cpp\"\nint N, Q, A[200020],\
    \ cnt[1000010];\nstruct query {\n    unsigned l, r;\n};\nusing namespace zawa;\n\
    void solve() {\n    std::cin >> N >> Q;\n    for (int i = 0 ; i < N ; i++) std::cin\
    \ >> A[i];\n    std::vector<query> q(Q);\n    for (int i = 0 ; i < Q ; i++) {\n\
    \        std::cin >> q[i].l >> q[i].r;\n        q[i].l--;\n    }\n    int odd\
    \ = 0;\n    auto op = [&](int i) {\n        cnt[A[i]] ^= 1;\n        odd += (cnt[A[i]]\
    \ ? 1 : -1);\n    };\n    auto eval = [&](int) -> bool {\n        return odd ==\
    \ 0;\n    };\n    for (bool ans : Mo(q, op, op, op, op, eval, true)) std::cout\
    \ << (ans ? \"YES\\n\" : \"NO\\n\");\n}\n\nint main() {\n#ifdef ONLINE_JUDGE\n\
    \    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n    std::ios::sync_with_stdio(false);\n\
    \    int T;\n    std::cin >> T;\n    while (T--) solve();\n#else\n    std::cout\
    \ << \"Hello World\\n\";\n#endif\n}\n"
  code: "#define PROBLEM \"https://onlinejudge.u-aizu.ac.jp/courses/lesson/2/ITP1/1/ITP1_1_A\"\
    \n// #define PROBLEM \"https://codeforces.com/contest/2014/problem/H\"\n\n/*\n\
    \ * Codeforces Round 974 (Div. 3) H. Robin Hood Archery\n * https://codeforces.com/contest/2014/submission/315528073\n\
    \ */\n\n#include \"../../Src/DataStructure/Mo/Mo.hpp\"\n\n#include <iostream>\n\
    #include <vector>\nint N, Q, A[200020], cnt[1000010];\nstruct query {\n    unsigned\
    \ l, r;\n};\nusing namespace zawa;\nvoid solve() {\n    std::cin >> N >> Q;\n\
    \    for (int i = 0 ; i < N ; i++) std::cin >> A[i];\n    std::vector<query> q(Q);\n\
    \    for (int i = 0 ; i < Q ; i++) {\n        std::cin >> q[i].l >> q[i].r;\n\
    \        q[i].l--;\n    }\n    int odd = 0;\n    auto op = [&](int i) {\n    \
    \    cnt[A[i]] ^= 1;\n        odd += (cnt[A[i]] ? 1 : -1);\n    };\n    auto eval\
    \ = [&](int) -> bool {\n        return odd == 0;\n    };\n    for (bool ans :\
    \ Mo(q, op, op, op, op, eval, true)) std::cout << (ans ? \"YES\\n\" : \"NO\\n\"\
    );\n}\n\nint main() {\n#ifdef ONLINE_JUDGE\n    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n\
    \    std::ios::sync_with_stdio(false);\n    int T;\n    std::cin >> T;\n    while\
    \ (T--) solve();\n#else\n    std::cout << \"Hello World\\n\";\n#endif\n}\n"
  dependsOn:
  - Src/DataStructure/Mo/Mo.hpp
  - Src/Template/TypeAlias.hpp
  isVerificationFile: true
  path: Test/CF/CF974-H.test.cpp
  requiredBy: []
  timestamp: '2025-04-14 13:20:45+09:00'
  verificationStatus: TEST_ACCEPTED
  verifiedWith: []
documentation_of: Test/CF/CF974-H.test.cpp
layout: document
redirect_from:
- /verify/Test/CF/CF974-H.test.cpp
- /verify/Test/CF/CF974-H.test.cpp.html
title: Test/CF/CF974-H.test.cpp
---
